<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details - Local</title>
    <link rel="stylesheet" href="product.css">
</head>
<body>
    
    <div class="product-header">
        <a href="index.html" class="back-btn">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            <span>back</span>
        </a>
        <img id="headerImage" src="" alt="Product">
    </div>

    <!-- Product Details Container -->
    <div class="product-container">
        <div class="product-image-container">
            <img id="productImage" src="" alt="Product">
        </div>

        <div class="product-info">
            <div class="product-title-row">
                <h1 id="productName" class="product-name"></h1>
                <button class="favorite-btn" id="favoriteBtn">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                </button>
            </div>

            <div class="product-rating">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="#FFD700" stroke="none">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                <span id="productRating" class="rating-text"></span>
            </div>

            <div class="product-time">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <span id="productTime"></span>
            </div>

            <hr class="divider">

            <div class="select-option">
                <h2 class="section-title">Select Option</h2>

                <label class="option-item">
                    <div class="option-content">
                        <div class="option-text">
                            <span class="option-name">Regular</span>
                            <div class="option-badge-container">
                                <span class="option-badge">Popular</span>
                                <span class="option-subtitle">#1 most ordered</span>
                            </div>
                        </div>
                        <span id="regularPrice" class="option-price">S$7</span>
                    </div>
                    <input type="radio" name="option" value="regular" checked>
                    <span class="radio-custom"></span>
                </label>

                <label class="option-item">
                    <div class="option-content">
                        <div class="option-text">
                            <span class="option-name">Premium</span>
                            <span class="option-subtitle">up-sized</span>
                        </div>
                        <span id="premiumPrice" class="option-price">S$12.50</span>
                    </div>
                    <input type="radio" name="option" value="premium">
                    <span class="radio-custom"></span>
                </label>
            </div>

            <button class="add-to-cart-btn" onclick="addToCart()">Add to Cart</button>
        </div>
    </div>

    <script>
        // Get product data from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const productName = urlParams.get('name') || 'Singapore Laksa';
        const productImage = urlParams.get('image') || 'resource/laksa.png';
        const productRating = urlParams.get('rating') || '4.9';
        const productReviews = urlParams.get('reviews') || '159';
        const productTime = urlParams.get('time') || '20min';
        const productPrice = urlParams.get('price') || '$7';

        // Set product data
        document.getElementById('productName').textContent = productName;
        document.getElementById('productImage').src = productImage;
        document.getElementById('headerImage').src = productImage;
        document.getElementById('productRating').textContent = `${productRating} (${productReviews})`;
        document.getElementById('productTime').textContent = `Est:${productTime}`;
        document.getElementById('regularPrice').textContent = productPrice;
        
        // Calculate premium price (adding $5.50 to regular price)
        const regularPriceNum = parseFloat(productPrice.replace('$', ''));
        const premiumPriceNum = (regularPriceNum + 5.50).toFixed(2);
        document.getElementById('premiumPrice').textContent = `$${premiumPriceNum}`;

        // Check if item is in favorites
        function checkFavorite() {
            const favourites = JSON.parse(localStorage.getItem('favourites')) || [];
            const isFavorite = favourites.some(fav => fav.name === productName);
            const svg = document.querySelector('#favoriteBtn svg');
            if (isFavorite) {
                svg.setAttribute('fill', '#c13000');
            }
        }

        // Toggle favorite
        document.getElementById('favoriteBtn').addEventListener('click', function() {
            const svg = this.querySelector('svg');
            const currentFill = svg.getAttribute('fill');
            
            const itemData = {
                name: productName,
                price: productPrice,
                time: productTime,
                rating: productRating,
                reviews: productReviews,
                image: productImage
            };
            
            let favourites = JSON.parse(localStorage.getItem('favourites')) || [];
            
            if (currentFill === 'none') {
                svg.setAttribute('fill', '#c13000');
                if (!favourites.some(fav => fav.name === itemData.name)) {
                    favourites.push(itemData);
                }
            } else {
                svg.setAttribute('fill', 'none');
                favourites = favourites.filter(fav => fav.name !== itemData.name);
            }
            
            localStorage.setItem('favourites', JSON.stringify(favourites));
        });

        // Add to cart function
        function addToCart() {
            const selectedOption = document.querySelector('input[name="option"]:checked').value;
            const price = selectedOption === 'regular' ? productPrice : `$${premiumPriceNum}`;
            
            // Save to cart in localStorage
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            cart.push({
                name: productName,
                image: productImage,
                option: selectedOption,
                price: price,
                quantity: 1,
                rating: productRating,
                reviews: productReviews,
                time: productTime
            });
            localStorage.setItem('cart', JSON.stringify(cart));
            
            // Navigate to cart page
            window.location.href = 'cart.html';
        }

        // Initialize
        checkFavorite();
    </script>
</body>
</html>
